WITH filtered_minutes AS (
  SELECT
    price,
    minute
  FROM prices.usd
  WHERE
    "contract_address" = FROM_HEX('2be5e8c109e2197D077D13A82dAead6a9b3433C5')
    AND TRY_CAST(minute AS TIME) = TRY_CAST('23:59:00' AS TIME)
    AND DATE(minute) IN (
      TRY_CAST('2023-10-24' AS DATE), TRY_CAST('2023-10-25' AS DATE), TRY_CAST('2023-10-26' AS DATE), TRY_CAST('2023-10-27' AS DATE), TRY_CAST('2023-10-29' AS DATE), TRY_CAST('2023-10-31' AS DATE), TRY_CAST('2023-11-01' AS DATE), TRY_CAST('2023-11-03' AS DATE), TRY_CAST('2023-11-04' AS DATE), TRY_CAST('2023-11-05' AS DATE), TRY_CAST('2023-11-06' AS DATE), TRY_CAST('2023-11-07' AS DATE), TRY_CAST('2023-11-08' AS DATE), TRY_CAST('2023-11-09' AS DATE), TRY_CAST('2023-11-10' AS DATE), TRY_CAST('2023-11-11' AS DATE), TRY_CAST('2023-11-12' AS DATE), TRY_CAST('2023-11-13' AS DATE), TRY_CAST('2023-11-14' AS DATE), TRY_CAST('2023-11-15' AS DATE), TRY_CAST('2023-11-16' AS DATE), TRY_CAST('2023-11-17' AS DATE), TRY_CAST('2023-11-18' AS DATE), TRY_CAST('2023-11-19' AS DATE), TRY_CAST('2023-11-20' AS DATE), TRY_CAST('2023-11-21' AS DATE), TRY_CAST('2023-11-22' AS DATE), TRY_CAST('2023-11-23' AS DATE), TRY_CAST('2023-11-24' AS DATE), TRY_CAST('2023-11-25' AS DATE), TRY_CAST('2023-11-27' AS DATE), TRY_CAST('2023-11-28' AS DATE), TRY_CAST('2023-11-29' AS DATE), TRY_CAST('2023-11-30' AS DATE), TRY_CAST('2023-12-01' AS DATE), TRY_CAST('2023-12-02' AS DATE), TRY_CAST('2023-12-05' AS DATE), TRY_CAST('2023-12-06' AS DATE), TRY_CAST('2023-12-07' AS DATE), TRY_CAST('2023-12-08' AS DATE), TRY_CAST('2023-12-10' AS DATE), TRY_CAST('2023-12-12' AS DATE), TRY_CAST('2023-12-16' AS DATE), TRY_CAST('2023-12-17' AS DATE), TRY_CAST('2023-12-18' AS DATE), TRY_CAST('2023-12-21' AS DATE), TRY_CAST('2023-12-22' AS DATE), TRY_CAST('2023-12-25' AS DATE), TRY_CAST('2023-12-26' AS DATE), TRY_CAST('2023-12-27' AS DATE), TRY_CAST('2023-12-30' AS DATE), TRY_CAST('2023-12-31' AS DATE), TRY_CAST('2024-01-01' AS DATE), TRY_CAST('2024-01-03' AS DATE), TRY_CAST('2024-01-06' AS DATE), TRY_CAST('2024-01-07' AS DATE), TRY_CAST('2024-01-08' AS DATE), TRY_CAST('2024-01-10' AS DATE), TRY_CAST('2024-01-11' AS DATE), TRY_CAST('2024-01-12' AS DATE), TRY_CAST('2024-01-16' AS DATE), TRY_CAST('2024-01-17' AS DATE), TRY_CAST('2024-01-18' AS DATE), TRY_CAST('2024-01-19' AS DATE), TRY_CAST('2024-01-20' AS DATE), TRY_CAST('2024-01-21' AS DATE), TRY_CAST('2024-01-22' AS DATE), TRY_CAST('2024-01-23' AS DATE), TRY_CAST('2024-01-24' AS DATE), TRY_CAST('2024-01-27' AS DATE), TRY_CAST('2024-01-28' AS DATE), TRY_CAST('2024-01-29' AS DATE), TRY_CAST('2024-01-30' AS DATE), TRY_CAST('2024-01-31' AS DATE), TRY_CAST('2024-02-01' AS DATE), TRY_CAST('2024-02-02' AS DATE), TRY_CAST('2024-02-04' AS DATE), TRY_CAST('2024-02-05' AS DATE), TRY_CAST('2024-02-06' AS DATE), TRY_CAST('2024-02-07' AS DATE), TRY_CAST('2024-02-10' AS DATE), TRY_CAST('2024-02-11' AS DATE), TRY_CAST('2024-02-12' AS DATE), TRY_CAST('2024-02-13' AS DATE), TRY_CAST('2024-02-14' AS DATE), TRY_CAST('2024-02-15' AS DATE), TRY_CAST('2024-02-16' AS DATE), TRY_CAST('2024-02-17' AS DATE), TRY_CAST('2024-02-18' AS DATE), TRY_CAST('2024-02-19' AS DATE), TRY_CAST('2024-02-20' AS DATE), TRY_CAST('2024-02-21' AS DATE), TRY_CAST('2024-02-22' AS DATE), TRY_CAST('2024-02-27' AS DATE), TRY_CAST('2024-02-28' AS DATE), TRY_CAST('2024-03-02' AS DATE), TRY_CAST('2024-03-03' AS DATE), TRY_CAST('2024-03-05' AS DATE), TRY_CAST('2024-03-07' AS DATE), TRY_CAST('2024-03-09' AS DATE), TRY_CAST('2024-03-10' AS DATE), TRY_CAST('2024-03-11' AS DATE), TRY_CAST('2024-03-12' AS DATE), TRY_CAST('2024-03-14' AS DATE), TRY_CAST('2024-03-16' AS DATE), TRY_CAST('2024-03-17' AS DATE), TRY_CAST('2024-03-18' AS DATE), TRY_CAST('2024-03-19' AS DATE), TRY_CAST('2024-03-20' AS DATE), TRY_CAST('2024-03-21' AS DATE), TRY_CAST('2024-03-22' AS DATE), TRY_CAST('2024-03-23' AS DATE), TRY_CAST('2024-03-25' AS DATE), TRY_CAST('2024-03-28' AS DATE), TRY_CAST('2024-03-30' AS DATE), TRY_CAST('2024-03-31' AS DATE), TRY_CAST('2024-04-02' AS DATE), TRY_CAST('2024-04-03' AS DATE), TRY_CAST('2024-04-04' AS DATE), TRY_CAST('2024-04-05' AS DATE), TRY_CAST('2024-04-06' AS DATE), TRY_CAST('2024-04-10' AS DATE), TRY_CAST('2024-04-11' AS DATE), TRY_CAST('2024-04-13' AS DATE), TRY_CAST('2024-04-15' AS DATE), TRY_CAST('2024-04-16' AS DATE), TRY_CAST('2024-04-19' AS DATE), TRY_CAST('2024-04-20' AS DATE), TRY_CAST('2024-04-21' AS DATE), TRY_CAST('2024-04-22' AS DATE), TRY_CAST('2024-04-23' AS DATE), TRY_CAST('2024-04-25' AS DATE), TRY_CAST('2024-04-26' AS DATE), TRY_CAST('2024-04-29' AS DATE), TRY_CAST('2024-04-30' AS DATE), TRY_CAST('2024-05-01' AS DATE), TRY_CAST('2024-05-02' AS DATE), TRY_CAST('2024-05-05' AS DATE), TRY_CAST('2024-05-08' AS DATE), TRY_CAST('2024-05-09' AS DATE), TRY_CAST('2024-05-10' AS DATE), TRY_CAST('2024-05-14' AS DATE), TRY_CAST('2024-05-16' AS DATE), TRY_CAST('2024-05-17' AS DATE), TRY_CAST('2024-05-18' AS DATE), TRY_CAST('2024-05-22' AS DATE), TRY_CAST('2024-05-23' AS DATE), TRY_CAST('2024-05-28' AS DATE), TRY_CAST('2024-05-29' AS DATE), TRY_CAST('2024-05-30' AS DATE), TRY_CAST('2024-05-31' AS DATE), TRY_CAST('2024-06-05' AS DATE), TRY_CAST('2024-06-06' AS DATE), TRY_CAST('2024-06-07' AS DATE), TRY_CAST('2024-06-08' AS DATE), TRY_CAST('2024-06-10' AS DATE), TRY_CAST('2024-06-11' AS DATE), TRY_CAST('2024-06-14' AS DATE), TRY_CAST('2024-06-15' AS DATE), TRY_CAST('2024-06-16' AS DATE), TRY_CAST('2024-06-17' AS DATE), TRY_CAST('2024-06-18' AS DATE), TRY_CAST('2024-06-19' AS DATE), TRY_CAST('2024-06-22' AS DATE), TRY_CAST('2024-06-23' AS DATE), TRY_CAST('2024-06-25' AS DATE), TRY_CAST('2024-06-26' AS DATE), TRY_CAST('2024-06-27' AS DATE), TRY_CAST('2024-06-28' AS DATE), TRY_CAST('2024-06-30' AS DATE), TRY_CAST('2024-07-01' AS DATE), TRY_CAST('2024-07-02' AS DATE), TRY_CAST('2024-07-05' AS DATE), TRY_CAST('2024-07-07' AS DATE), TRY_CAST('2024-07-09' AS DATE), TRY_CAST('2024-07-11' AS DATE), TRY_CAST('2024-07-14' AS DATE), TRY_CAST('2024-07-15' AS DATE), TRY_CAST('2024-07-16' AS DATE), TRY_CAST('2024-07-17' AS DATE), TRY_CAST('2024-07-18' AS DATE), TRY_CAST('2024-07-20' AS DATE), TRY_CAST('2024-07-21' AS DATE), TRY_CAST('2024-07-22' AS DATE), TRY_CAST('2024-07-23' AS DATE), TRY_CAST('2024-07-26' AS DATE), TRY_CAST('2024-07-27' AS DATE), TRY_CAST('2024-07-28' AS DATE), TRY_CAST('2024-07-29' AS DATE), TRY_CAST('2024-07-31' AS DATE), TRY_CAST('2024-08-01' AS DATE), TRY_CAST('2024-08-02' AS DATE), TRY_CAST('2024-08-03' AS DATE), TRY_CAST('2024-08-04' AS DATE), TRY_CAST('2024-08-06' AS DATE), TRY_CAST('2024-08-07' AS DATE), TRY_CAST('2024-08-08' AS DATE), TRY_CAST('2024-08-10' AS DATE), TRY_CAST('2024-08-13' AS DATE), TRY_CAST('2024-08-14' AS DATE), TRY_CAST('2024-08-16' AS DATE), TRY_CAST('2024-08-20' AS DATE), TRY_CAST('2024-08-22' AS DATE), TRY_CAST('2024-08-23' AS DATE), TRY_CAST('2024-08-24' AS DATE), TRY_CAST('2024-08-25' AS DATE), TRY_CAST('2024-08-28' AS DATE), TRY_CAST('2024-08-30' AS DATE), TRY_CAST('2024-09-02' AS DATE), TRY_CAST('2024-09-03' AS DATE), TRY_CAST('2024-09-04' AS DATE), TRY_CAST('2024-09-05' AS DATE), TRY_CAST('2024-09-06' AS DATE), TRY_CAST('2024-09-07' AS DATE), TRY_CAST('2024-09-09' AS DATE), TRY_CAST('2024-09-11' AS DATE), TRY_CAST('2024-09-12' AS DATE), TRY_CAST('2024-09-16' AS DATE), TRY_CAST('2024-09-17' AS DATE), TRY_CAST('2024-09-18' AS DATE), TRY_CAST('2024-09-19' AS DATE), TRY_CAST('2024-09-20' AS DATE), TRY_CAST('2024-09-21' AS DATE), TRY_CAST('2024-09-22' AS DATE), TRY_CAST('2024-09-23' AS DATE), TRY_CAST('2024-09-24' AS DATE), TRY_CAST('2024-09-25' AS DATE), TRY_CAST('2024-09-26' AS DATE), TRY_CAST('2024-09-28' AS DATE), TRY_CAST('2024-10-02' AS DATE), TRY_CAST('2024-10-04' AS DATE), TRY_CAST('2024-10-06' AS DATE), TRY_CAST('2024-10-07' AS DATE), TRY_CAST('2024-10-09' AS DATE), TRY_CAST('2024-10-10' AS DATE), TRY_CAST('2024-10-14' AS DATE), TRY_CAST('2024-10-15' AS DATE), TRY_CAST('2024-10-17' AS DATE), TRY_CAST('2024-10-19' AS DATE), TRY_CAST('2024-10-20' AS DATE), TRY_CAST('2024-10-21' AS DATE), TRY_CAST('2024-10-22' AS DATE), TRY_CAST('2024-10-23' AS DATE), TRY_CAST('2024-10-24' AS DATE), TRY_CAST('2024-10-27' AS DATE), TRY_CAST('2024-10-28' AS DATE), TRY_CAST('2024-10-29' AS DATE), TRY_CAST('2024-10-30' AS DATE), TRY_CAST('2024-10-31' AS DATE), TRY_CAST('2024-11-01' AS DATE), TRY_CAST('2024-11-03' AS DATE), TRY_CAST('2024-11-04' AS DATE), TRY_CAST('2024-11-05' AS DATE), TRY_CAST('2024-11-07' AS DATE), TRY_CAST('2024-11-08' AS DATE), TRY_CAST('2024-11-10' AS DATE), TRY_CAST('2024-11-11' AS DATE), TRY_CAST('2024-11-12' AS DATE), TRY_CAST('2024-11-13' AS DATE), TRY_CAST('2024-11-14' AS DATE), TRY_CAST('2024-11-15' AS DATE), TRY_CAST('2024-11-16' AS DATE), TRY_CAST('2024-11-18' AS DATE), TRY_CAST('2024-11-20' AS DATE), TRY_CAST('2024-11-21' AS DATE), TRY_CAST('2024-11-22' AS DATE), TRY_CAST('2024-11-24' AS DATE), TRY_CAST('2024-11-25' AS DATE), TRY_CAST('2024-11-26' AS DATE), TRY_CAST('2024-11-27' AS DATE), TRY_CAST('2024-11-28' AS DATE), TRY_CAST('2024-11-29' AS DATE), TRY_CAST('2024-11-30' AS DATE), TRY_CAST('2024-12-03' AS DATE), TRY_CAST('2024-12-05' AS DATE), TRY_CAST('2024-12-06' AS DATE), TRY_CAST('2024-12-08' AS DATE), TRY_CAST('2024-12-09' AS DATE), TRY_CAST('2024-12-10' AS DATE), TRY_CAST('2024-12-13' AS DATE), TRY_CAST('2024-12-14' AS DATE), TRY_CAST('2024-12-16' AS DATE), TRY_CAST('2024-12-17' AS DATE), TRY_CAST('2024-12-21' AS DATE), TRY_CAST('2024-12-22' AS DATE), TRY_CAST('2024-12-23' AS DATE), TRY_CAST('2025-01-01' AS DATE), TRY_CAST('2025-01-02' AS DATE), TRY_CAST('2025-01-04' AS DATE), TRY_CAST('2025-01-05' AS DATE), TRY_CAST('2025-01-06' AS DATE), TRY_CAST('2025-01-07' AS DATE), TRY_CAST('2025-01-08' AS DATE), TRY_CAST('2025-01-09' AS DATE), TRY_CAST('2025-01-12' AS DATE), TRY_CAST('2025-01-13' AS DATE), TRY_CAST('2025-01-15' AS DATE), TRY_CAST('2025-01-18' AS DATE), TRY_CAST('2025-01-19' AS DATE), TRY_CAST('2025-01-20' AS DATE), TRY_CAST('2025-01-21' AS DATE)
    )
)
SELECT
  price,
  minute
FROM filtered_minutes
ORDER BY
  minute DESC
LIMIT 1000;





